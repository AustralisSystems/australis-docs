$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://example.com/schemas/doctrine-schema.json"
title: "Doctrine Schema (MCP Tier)"
type: object
additionalProperties: false
required:
  - version
  - schema
  - id
  - title
  - description
properties:
  version:
    type: string
    description: "Required. Semantic schema version for the doctrine document (e.g., '1.0')."
  schema:
    type: string
    const: "mcp.doctrine/v1"
    description: "Required. Logical schema identifier for doctrine files (fixed: 'mcp.doctrine/v1')."
  id:
    type: string
    pattern: "^[a-z0-9_.:-]+$"
    description: "Required. Canonical identifier for the doctrine (lowercase, allowed chars: a-z0-9_.:-)."
  title:
    type: string
    description: "Required. Short human-readable title for the doctrine."
  description:
    type: string
    description: "Required. Concise description of the doctrine's intent and scope."
  purpose:
    type: string
    description: "Optional. Higher-level rationale or business purpose for this doctrine."
  scope:
    type: array
    items:
      type: string
    description: "Optional. List of repository paths, modules, or domains the doctrine applies to."
  policies:
    type: array
    items:
      type: object
      required:
        - id
        - title
      properties:
        id:
          type: string
          description: "Required. Policy identifier; unique within this doctrine."
        title:
          type: string
          description: "Required. Short title for the policy."
        description:
          type: string
          description: "Optional. Full description and rationale for the policy."
    description: "Optional. Array of governing policies derived from this doctrine."
  protocols:
    type: array
    items:
      type: string
    description: "Optional. List of protocol ids that implement this doctrine."
  enforce:
    type: boolean
    description: "Optional. If true, this doctrine is considered enforceable and violations should be treated as blocking."
  notes:
    type: array
    items:
      type: string
    description: "Optional. Free-form notes, clarifications, or governance comments."
  raw:
    type: string
    description: "Optional. Embedded original content or extended notes for traceability. Prefer using raw_ref for large or sensitive content."
  raw_ref:
    type: string
    format: uri
    description: "Optional. Reference (URI or repo path) to original/raw content stored externally. Use for large or sensitive items."
  raw_hash:
    type: string
    pattern: "^[A-Fa-f0-9]{64}$"
    description: "Optional. SHA-256 hex digest of the original content for integrity verification."
